<o-form class="form" editable-detail="yes" show-header="no">

  <o-column title="{{ 'SEARCH_BAR' | oTranslate }}">
    <o-row layout-align="space-between center">

      <o-text-input attr="name" read-only="no" fxFlex="100" label="Search"></o-text-input>


      <o-row layout-align="end center" class="btn-container">
        <button attr="filter" [oFilterBuilderQuery]="filterBuilder" type="RAISED" label="Search" class="filter-button"
          matTooltip="{{ 'Search' | oTranslate }}">
          <mat-icon class="material-icons">search</mat-icon>
        </button>
        <button attr="clear" [oFilterBuilderClear]="filterBuilder" type="RAISED" label="Clear" class="filter-button"
          matTooltip="{{ 'Clear' | oTranslate }}" (click)="clearFilters()">
          <mat-icon class="material-icons">clear</mat-icon>
        </button>
      </o-row>
    </o-row>

    <o-combo
        label="category"
        [oFilterBuilderQuery]="filterBuilder"
        id="category"
        null-selection="no"
        attr="category"
        service="categories"
        entity="category"
        keys="categoryid"
        value-column="codigo"
        columns="categoryid;name;codigo"
        searchable="true"
        visible-columns="codigo"
        multiple="yes"
        translate="yes">
      </o-combo>

      <o-combo label="status" [oFilterBuilderQuery]="filterBuilder" id="status" null-selection="no" attr="status" service="statuses" entity="status" keys="statusid" value-column="code" columns="statusid;name;code" searchable="true" visible-columns="code" multiple="yes" translate="yes"></o-combo>

  </o-column>

  <o-filter-builder #filterBuilder attr="thefilter" filters="NAME:name;DESCRIPTION:name;CATEGORY:category;STATUS:status" [target]="toysGrid"
    query-on-change="no" query-on-change-delay="500" [expression-builder]="createFilter"></o-filter-builder>
</o-form>


<o-column-collapsible title="{{ 'VIEW_MAP' | oTranslate }}" appearance="legacy" expanded="no" icon="location_on"
  class="collapsible">
  <location-map></location-map>
</o-column-collapsible>

<div >
  <o-grid #toysGrid attr="toysGrid" service="toys" entity="toy" keys="toyid" detail-form-route="toysDetail"
    columns="toyid;photo;name;price;latitude;longitude" query-rows="20" page-size-options="20" refresh-button="no"
    quick-filter="no" pagination-controls="yes" show-page-size="yes" page-size-options="24;32;64"
    (onDataLoaded)="addLocation($event)">


    <o-grid-item *ngFor="let data of toysGrid.dataArray" (onClick)="openDetail(data)">
      <o-column layout-padding class="toy-card">
        <img src="http://localhost:8080/restapi/get-image?toyId={{data.toyid}}" alt="" class="img-toy" style="margin-top:8px;">
        <div class="body" style="padding: 0 1em;" fxLayout="column" fxLayoutAlign="start center">
          <h4 class="toy-title">{{ data.name }}</h4>

          <div fxLayout="row" fxLayoutGap=".5em">
            <div fxLayout="column" fxLayoutAlign="start center">
              <mat-icon>credit_card</mat-icon>
              <mat-icon *ngIf="data.location != null">connect_without_contact</mat-icon>
            </div>
            <div fxLayout="column" fxLayoutAlign="start start">
              <span>{{ data.price }} â‚¬</span>
              <span *ngIf="data.location != null">{{data.location}} Km</span>
            </div>
          </div>
        </div>
      </o-column>
    </o-grid-item>
  </o-grid>
</div>
